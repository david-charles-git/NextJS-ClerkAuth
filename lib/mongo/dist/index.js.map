{"version":3,"sources":["index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,mCAAsC;AAEhC,IAAA,gBAA6C,EAA3C,4BAAW,EAAE,kCAA8B,CAAC;AAEpD,IAAI,CAAC,WAAW,EAAE;IAAE,MAAM,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;CAAE;AAErF,IAAI,CAAC,cAAc,EAAE;IAAE,MAAM,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;CAAE;AAExF,IAAI,gBAAgB,GAAS,MAAM,CAAC,KAAK,CAAC;AAE1C,IAAI,CAAC,gBAAgB,EAAE;IAAE,gBAAgB,GAAG,MAAM,CAAC,KAAK,GAAG,EAAE,IAAI,EAAG,IAAI,EAAE,OAAO,EAAG,IAAI,EAAE,CAAC;CAAE;AAE7F,IAAM,iBAAiB,GAAG;;;;;gBACtB,IAAI,gBAAgB,CAAC,IAAI;oBAAE,sBAAO,gBAAgB,CAAC,IAAI,EAAC;qBAEpD,CAAC,gBAAgB,CAAC,OAAO,EAAzB,wBAAyB;gBACnB,OAAO,GAAG;oBACZ,eAAe,EAAG,IAAI;oBACtB,kBAAkB,EAAG,IAAI;iBAC5B,CAAC;gBAEF,KAAA,gBAAgB,CAAA;gBAAW,qBAAM,qBAAW,CAAC,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,UAAC,MAAM;wBACnF,OAAO;4BACH,MAAM,QAAA;4BACN,MAAM,EAAE,MAAM,CAAC,EAAE,CAAC,cAAc,CAAC;yBACpC,CAAA;oBACL,CAAC,CAAC,EAAA;;gBALF,GAAiB,OAAO,GAAG,SAKzB,CAAC;;;gBAGP,KAAA,gBAAgB,CAAA;gBAAQ,qBAAM,gBAAgB,CAAC,OAAO,EAAA;;gBAAtD,GAAiB,IAAI,GAAG,SAA8B,CAAC;;;;KAC1D,CAAC;AAEO,8CAAiB","file":"index.js","sourcesContent":["import { MongoClient } from \"mongodb\";\r\n\r\nconst { MONGODB_URI, MONGODB_DB_ONE } = process.env;\r\n\r\nif (!MONGODB_URI) { throw new Error(\"Please define the MONGODC_URI in .env.local\"); }\r\n\r\nif (!MONGODB_DB_ONE) { throw new Error(\"Please define the MONGODB_DB  in .env.local\"); }\r\n\r\nlet cachedConnection : any = global.mongo;\r\n\r\nif (!cachedConnection) { cachedConnection = global.mongo = { conn : null, promise : null }; }\r\n\r\nconst connectToDatabase = async () => {\r\n    if (cachedConnection.conn) return cachedConnection.conn;\r\n\r\n    if (!cachedConnection.promise) {\r\n        const options = {\r\n            useNewUrlParser : true,\r\n            useUnifiedTopology : true\r\n        };\r\n\r\n        cachedConnection.promise = await MongoClient.connect(MONGODB_URI, options).then((client) => {\r\n            return {\r\n                client,\r\n                db_one: client.db(MONGODB_DB_ONE)\r\n            }\r\n        });\r\n    }\r\n\r\n    cachedConnection.conn = await cachedConnection.promise;\r\n};\r\n\r\nexport { connectToDatabase };"]}